import{c as V,r as l,f as R,j as e,a as T,B as C,b as D}from"./index-e5McNQoe.js";import{u as A}from"./carStore-BSRS0qky.js";import{T as Y,a as $,b as E,c as w,d as W,e as k}from"./table-Bm7zu1Uw.js";import{C as X,D as F,a as I,b as q,c as M,d as G,e as J,T as K}from"./dialog-CcjJem-s.js";import{u as Q}from"./index.esm-DYy7PH6Z.js";import{L as g,I as y}from"./label-C1OOFmtH.js";import{u as Z,c as ee,b as se}from"./Combination--97WpBTF.js";import{u as te}from"./index-C8uNl_fY.js";import{P as B}from"./index-CS41xu9O.js";/**
 * @license lucide-react v0.514.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],re=V("square-pen",ae);function ie(s){const i=l.useRef({value:s,previous:s});return l.useMemo(()=>(i.current.value!==s&&(i.current.previous=i.current.value,i.current.value=s),i.current.previous),[s])}var P="Switch",[ne,we]=ee(P),[ce,le]=ne(P),_=l.forwardRef((s,i)=>{const{__scopeSwitch:n,name:d,checked:o,defaultChecked:h,required:a,disabled:u,value:p="on",onCheckedChange:m,form:r,...j}=s,[f,b]=l.useState(null),v=R(i,S=>b(S)),c=l.useRef(!1),t=f?r||!!f.closest("form"):!0,[x,N]=Z({prop:o,defaultProp:h??!1,onChange:m,caller:P});return e.jsxs(ce,{scope:n,checked:x,disabled:u,children:[e.jsx(B.button,{type:"button",role:"switch","aria-checked":x,"aria-required":a,"data-state":H(x),"data-disabled":u?"":void 0,disabled:u,value:p,...j,ref:v,onClick:se(s.onClick,S=>{N(z=>!z),t&&(c.current=S.isPropagationStopped(),c.current||S.stopPropagation())})}),t&&e.jsx(O,{control:f,bubbles:!c.current,name:d,value:p,checked:x,required:a,disabled:u,form:r,style:{transform:"translateX(-100%)"}})]})});_.displayName=P;var L="SwitchThumb",U=l.forwardRef((s,i)=>{const{__scopeSwitch:n,...d}=s,o=le(L,n);return e.jsx(B.span,{"data-state":H(o.checked),"data-disabled":o.disabled?"":void 0,...d,ref:i})});U.displayName=L;var oe="SwitchBubbleInput",O=l.forwardRef(({__scopeSwitch:s,control:i,checked:n,bubbles:d=!0,...o},h)=>{const a=l.useRef(null),u=R(a,h),p=ie(n),m=te(i);return l.useEffect(()=>{const r=a.current;if(!r)return;const j=window.HTMLInputElement.prototype,b=Object.getOwnPropertyDescriptor(j,"checked").set;if(p!==n&&b){const v=new Event("click",{bubbles:d});b.call(r,n),r.dispatchEvent(v)}},[p,n,d]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...o,tabIndex:-1,ref:u,style:{...o.style,...m,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});O.displayName=oe;function H(s){return s?"checked":"unchecked"}var de=_,ue=U;function me({className:s,...i}){return e.jsx(de,{"data-slot":"switch",className:T("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",s),...i,children:e.jsx(ue,{"data-slot":"switch-thumb",className:T("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}const he=({car:s,onFinished:i})=>{const{register:n,handleSubmit:d,setValue:o,watch:h,formState:{errors:a}}=Q(),{createCar:u,updateCar:p,isLoading:m}=A(),[r,j]=l.useState(null),f=h("availability",s?s.availability:!0);l.useEffect(()=>{s&&Object.keys(s).forEach(c=>{o(c,s[c])})},[s,o]);const b=c=>{var N;const t=(N=c.target.files)==null?void 0:N[0];if(!t)return;const x=new FileReader;x.readAsDataURL(t),x.onload=()=>{j(x.result)}},v=async c=>{c.year=parseInt(c.year,10),c.pricePerDay=parseFloat(c.pricePerDay);const t={...c};r&&(t.imageUrl=r),(s?await p(s.id,t):await u(t))&&i()};return e.jsxs("form",{onSubmit:d(v),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(g,{htmlFor:"make",children:"Make"}),e.jsx(y,{id:"make",...n("make",{required:"Make is required"})}),a.make&&e.jsx("p",{className:"text-destructive text-sm mt-1",children:a.make.message})]}),e.jsxs("div",{children:[e.jsx(g,{htmlFor:"model",children:"Model"}),e.jsx(y,{id:"model",...n("model",{required:"Model is required"})}),a.model&&e.jsx("p",{className:"text-destructive text-sm mt-1",children:a.model.message})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(g,{htmlFor:"year",children:"Year"}),e.jsx(y,{id:"year",type:"number",...n("year",{required:"Year is required",valueAsNumber:!0})}),a.year&&e.jsx("p",{className:"text-destructive text-sm mt-1",children:a.year.message})]}),e.jsxs("div",{children:[e.jsx(g,{htmlFor:"type",children:"Type (e.g., Sedan, SUV)"}),e.jsx(y,{id:"type",...n("type",{required:"Type is required"})}),a.type&&e.jsx("p",{className:"text-destructive text-sm mt-1",children:a.type.message})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(g,{htmlFor:"pricePerDay",children:"Price Per Day"}),e.jsx(y,{id:"pricePerDay",type:"number",step:"0.01",...n("pricePerDay",{required:"Price is required",valueAsNumber:!0})}),a.pricePerDay&&e.jsx("p",{className:"text-destructive text-sm mt-1",children:a.pricePerDay.message})]}),e.jsxs("div",{children:[e.jsx(g,{htmlFor:"location",children:"Location"}),e.jsx(y,{id:"location",...n("location",{required:"Location is required"})}),a.location&&e.jsx("p",{className:"text-destructive text-sm mt-1",children:a.location.message})]})]}),e.jsxs("div",{children:[e.jsx(g,{htmlFor:"image",children:"Image"}),e.jsx(y,{id:"image",type:"file",accept:"image/*",onChange:b}),(r||(s==null?void 0:s.imageUrl))&&e.jsx("img",{src:r||s.imageUrl,alt:"Car preview",className:"mt-2 h-24 w-auto rounded border"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(me,{id:"availability",checked:f,onCheckedChange:c=>o("availability",c)}),e.jsx(g,{htmlFor:"availability",children:"Available for Rent"})]}),e.jsxs(C,{type:"submit",className:"w-full",disabled:m,children:[m&&e.jsx(D,{className:"mr-2 h-4 w-4 animate-spin"}),s?"Update Car":"Create Car"]})]})},ke=()=>{const{cars:s,fetchCars:i,deleteCar:n,isLoading:d}=A(),[o,h]=l.useState(!1),[a,u]=l.useState(null),[p,m]=l.useState(!1),[r,j]=l.useState(null);l.useEffect(()=>{i()},[i]);const f=t=>{u(t),h(!0)},b=()=>{u(null),h(!0)},v=t=>{j(t),m(!0)},c=async()=>{r&&await n(r.id)&&(m(!1),j(null))};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Car Management"}),e.jsxs(C,{onClick:b,children:[e.jsx(X,{className:"mr-2 h-4 w-4"})," Add New Car"]})]}),e.jsx(F,{open:o,onOpenChange:h,children:e.jsxs(I,{className:"sm:max-w-[625px]",children:[e.jsx(q,{children:e.jsx(M,{children:a?"Edit Car":"Add New Car"})}),e.jsx(he,{car:a,onFinished:()=>h(!1)})]})}),e.jsx(F,{open:p,onOpenChange:m,children:e.jsxs(I,{children:[e.jsxs(q,{children:[e.jsx(M,{children:"Are you absolutely sure?"}),e.jsxs(G,{children:['This action cannot be undone. This will permanently delete the "',r==null?void 0:r.make," ",r==null?void 0:r.model,'".']})]}),e.jsxs(J,{children:[e.jsx(C,{variant:"outline",onClick:()=>m(!1),children:"Cancel"}),e.jsxs(C,{variant:"destructive",onClick:c,disabled:d,children:[d&&e.jsx(D,{className:"mr-2 h-4 w-4 animate-spin"}),"Delete"]})]})]})}),d&&s.length===0?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(D,{className:"h-12 w-12 animate-spin text-primary"})}):e.jsx("div",{className:"border rounded-lg",children:e.jsxs(Y,{children:[e.jsx($,{children:e.jsxs(E,{children:[e.jsx(w,{children:"Image"}),e.jsx(w,{children:"Make & Model"}),e.jsx(w,{children:"Price/Day"}),e.jsx(w,{children:"Availability"}),e.jsx(w,{className:"text-right",children:"Actions"})]})}),e.jsx(W,{children:s.map(t=>e.jsxs(E,{children:[e.jsx(k,{children:e.jsx("img",{src:t.imageUrl||"https://placehold.co/100x60",alt:t.make,className:"w-24 h-16 object-cover rounded border"})}),e.jsxs(k,{children:[t.make," ",t.model," (",t.year,")"]}),e.jsxs(k,{children:["$",t.pricePerDay]}),e.jsx(k,{children:t.availability?"Available":"Booked"}),e.jsxs(k,{className:"text-right space-x-2",children:[e.jsx(C,{variant:"outline",size:"icon",onClick:()=>f(t),children:e.jsx(re,{className:"h-4 w-4"})}),e.jsx(C,{variant:"destructive",size:"icon",onClick:()=>v(t),children:e.jsx(K,{className:"h-4 w-4"})})]})]},t.id))})]})})]})};export{ke as default};
